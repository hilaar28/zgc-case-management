# XAMPP Configuration for ZGC Case Management
# Copy this file to: C:/xampp/apache/conf/extra/httpd-xampp.conf

Listen 8080

<VirtualHost *:8080>
    ServerName localhost
    ServerAlias zgc-case.local
    
    # Document root - React build output
    DocumentRoot "C:/Users/user/Documents/zgc-case-management/ui/build"
    
    # Serve React static files
    <Directory "C:/Users/user/Documents/zgc-case-management/ui/build">
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
        
        # Enable compression
        AddOutputFilterByType DEFLATE text/html text/css text/javascript application/javascript
    </Directory>
    
    # Proxy API requests to Node.js server
    ProxyPreserveHost On
    ProxyPass /api http://localhost:8082
    ProxyPassReverse /api http://localhost:8082
    
    # Proxy socket.io if used
    ProxyPass /socket.io http://localhost:8082/socket.io
    ProxyPassReverse /socket.io http://localhost:8082/socket.io
    
    # Handle React Router - serve index.html for all routes
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.html [L]
    
    # Error and access logs
    ErrorLog "C:/xampp/apache/logs/zgc-error.log"
    CustomLog "C:/xampp/apache/logs/zgc-access.log" combined
</VirtualHost>

# For external access (optional)
<VirtualHost *:8080>
    ServerName 0.0.0.0
    DocumentRoot "C:/Users/user/Documents/zgc-case-management/ui/build"
    
    <Directory "C:/Users/user/Documents/zgc-case-management/ui/build">
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>
    
    ProxyPass /api http://localhost:8082
    ProxyPassReverse /api http://localhost:8082
    
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.html [L]
</VirtualHost>
